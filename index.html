<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#2f6f3e" />
  <title>–ú—ñ–π –∫–∞–ª–µ–Ω–¥–∞—Ä —Å–∞–¥—ñ–≤–Ω–∏–∫–∞</title>

  <!-- PWA basics -->
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="apple-touch-icon" href="icon-192.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />

  <style>
    :root {
      --bg: #0f1a12;
      --card: #162319;
      --text: #e9f5ec;
      --muted: #b7d7bf;
      --accent: #5bd07a;
      --accent2: #2f6f3e;
      --line: rgba(255,255,255,.10);
      --shadow: 0 10px 25px rgba(0,0,0,.35);
      --r: 18px;
      font-synthesis-weight: none;
      text-rendering: optimizeLegibility;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    body {
      margin: 0; background: radial-gradient(1200px 800px at 20% 0%, #173322 0%, var(--bg) 55%);
      color: var(--text);
      font: 16px/1.4 -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Inter, Arial, sans-serif;
    }
    .wrap { max-width: 720px; margin: 0 auto; padding: 18px 14px 44px; }
    header {
      display:flex; align-items:flex-start; justify-content:space-between; gap: 10px; margin-top: 6px;
    }
    .title { font-size: 22px; font-weight: 800; letter-spacing: .2px; }
    .sub { color: var(--muted); font-size: 13px; margin-top: 4px; }
    .pill {
      border: 1px solid var(--line); background: rgba(255,255,255,.03);
      padding: 8px 10px; border-radius: 999px; font-size: 12px; color: var(--muted);
      display:flex; align-items:center; gap: 6px;
    }
    .grid { display:grid; gap: 12px; margin-top: 14px; }
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,.04) 0%, rgba(255,255,255,.02) 100%);
      border: 1px solid var(--line);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding: 14px;
    }
    .h { display:flex; align-items:center; justify-content:space-between; gap: 10px; }
    .h h2 { margin: 0; font-size: 16px; }
    .tag { font-size: 12px; color: var(--muted); border: 1px solid var(--line); padding: 4px 8px; border-radius: 999px;}
    .section { margin-top: 10px; border-top: 1px solid var(--line); padding-top: 10px; }
    .choice { margin-top: 10px; }
    .choiceTitle { display:flex; align-items:center; justify-content:space-between; gap:8px; }
    .choiceTitle b { font-size: 14px; }
    .time { color: var(--muted); font-size: 12px; }
    ul { margin: 8px 0 0 18px; padding: 0; }
    li { margin: 6px 0; }
    .tip {
      margin-top: 12px; padding: 10px 12px; border-radius: 14px;
      background: rgba(91,208,122,.08); border: 1px solid rgba(91,208,122,.22);
      color: #dff7e6;
    }
    .btnRow { display:flex; gap: 10px; flex-wrap: wrap; margin-top: 12px; }
    button {
      appearance:none; border: 1px solid var(--line); background: rgba(255,255,255,.03);
      color: var(--text); padding: 10px 12px; border-radius: 14px; font-weight: 700;
    }
    button.primary { border-color: rgba(91,208,122,.35); background: rgba(91,208,122,.16); }
    button:active { transform: translateY(1px); }
    .small { font-size: 12px; color: var(--muted); margin-top: 10px; }
    nav {
      position: sticky; bottom: 0; margin-top: 14px;
      background: rgba(15,26,18,.75); backdrop-filter: blur(10px);
      border: 1px solid var(--line); border-radius: 18px; padding: 10px;
      display:flex; gap: 8px; justify-content: space-between;
    }
    nav a {
      flex: 1; text-align:center; text-decoration:none; color: var(--muted);
      padding: 10px 8px; border-radius: 14px; border: 1px solid transparent;
      font-weight: 700; font-size: 13px;
    }
    nav a.active { color: var(--text); background: rgba(255,255,255,.04); border-color: var(--line); }
    .view { display:none; }
    .view.active { display:block; }
    .list { margin-top: 10px; display:grid; gap: 10px; }
    .item { border: 1px solid var(--line); border-radius: 14px; padding: 10px 12px; background: rgba(255,255,255,.02); }
    .item b { display:block; }
    .item .meta { color: var(--muted); font-size: 12px; margin-top: 4px; }
    .empty { color: var(--muted); text-align:center; padding: 16px 0; }
  </style>
</head>

<body>
<div class="wrap">
  <header>
    <div>
      <div class="title">–ú—ñ–π –∫–∞–ª–µ–Ω–¥–∞—Ä —Å–∞–¥—ñ–≤–Ω–∏–∫–∞ üå±</div>
      <div class="sub" id="subtitle">–ü–∞–≤–ª—ñ–≤–∫–∞, –í—ñ–Ω–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å ‚Ä¢ –º º—è–∫–∏–π —Ä–µ–∂–∏–º</div>
    </div>
    <div class="pill">üìÖ <span id="todayStr"></span></div>
  </header>

  <!-- TODAY -->
  <section class="view active" id="view-today">
    <div class="grid">
      <div class="card">
        <div class="h">
          <h2>–°—å–æ–≥–æ–¥–Ω—ñ</h2>
          <span class="tag">–û–±–µ—Ä–∏ —Ä—ñ–≤–µ–Ω—å</span>
        </div>

        <div class="choice">
          <div class="choiceTitle"><b>üü¢ –õ–µ–≥–∫–æ</b><span class="time">10‚Äì15 —Ö–≤</span></div>
          <ul id="easyList"></ul>
        </div>

        <div class="choice">
          <div class="choiceTitle"><b>üü° –•–æ—á—É —â–æ—Å—å –∑—Ä–æ–±–∏—Ç–∏</b><span class="time">15‚Äì30 —Ö–≤</span></div>
          <ul id="doList"></ul>
        </div>

        <div class="choice">
          <div class="choiceTitle"><b>üîµ –•–æ—á—É —Å—ñ—è—Ç–∏</b><span class="time">30‚Äì60 —Ö–≤</span></div>
          <ul id="sowList"></ul>
        </div>

        <div class="tip" id="tipBox"></div>

        <div class="btnRow">
          <button class="primary" id="btnDone">‚úî –Ø —â–æ—Å—å –∑—Ä–æ–±–∏–ª–∞</button>
          <button id="btnAddSowing">‚ûï –Ø –ø–æ—Å—ñ—è–ª–∞ / –ø–æ—Å–∞–¥–∏–ª–∞</button>
        </div>
        <div class="small" id="doneHint"></div>
      </div>

      <div class="card">
        <div class="h">
          <h2>–ú º—è–∫—ñ –ø—ñ–¥–∫–∞–∑–∫–∏ –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ</h2>
          <span class="tag">–¥–ª—è ‚Äú–º–æ—ó—Ö –ø–æ—Å—ñ–≤—ñ–≤‚Äù</span>
        </div>
        <div class="list" id="softReminders"></div>
        <div class="empty" id="noReminders" style="display:none;">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–∏—Ö –ø–æ—Å—ñ–≤—ñ–≤. –î–æ–¥–∞–π —â–æ—Å—å ‚Äî —ñ —è –ø—ñ–¥–∫–∞–∂—É, –∫–æ–ª–∏ –≥–ª—è–Ω—É—Ç–∏/–ø–æ–ª–∏—Ç–∏ üôÇ</div>
      </div>
    </div>
  </section>

  <!-- MY SOWINGS -->
  <section class="view" id="view-sowings">
    <div class="grid">
      <div class="card">
        <div class="h">
          <h2>–ú–æ—ó –ø–æ—Å—ñ–≤–∏</h2>
          <span class="tag" id="sowCount">0</span>
        </div>
        <div class="list" id="sowingList"></div>
        <div class="empty" id="emptySowings">–¢—É—Ç –∑‚Äô—è–≤–∏—Ç—å—Å—è —Å–ø–∏—Å–æ–∫, –∫–æ–ª–∏ —Ç–∏ –≤—ñ–¥–º—ñ—Ç–∏—à ‚Äú—è –ø–æ—Å—ñ—è–ª–∞ / –ø–æ—Å–∞–¥–∏–ª–∞‚Äù üåø</div>
      </div>

      <div class="card">
        <div class="h">
          <h2>–î–æ–¥–∞—Ç–∏ –ø–æ—Å—ñ–≤</h2>
          <span class="tag">1 —Ö–≤</span>
        </div>

        <div class="section">
          <label class="small">–©–æ —Ç–∏ –∑—Ä–æ–±–∏–ª–∞?</label><br/>
          <select id="sowType" style="width:100%; margin-top:6px; padding:10px 12px; border-radius:14px; border:1px solid var(--line); background:rgba(255,255,255,.03); color:var(--text);">
            <option value="microgreens">–ú—ñ–∫—Ä–æ–∑–µ–ª–µ–Ω—å</option>
            <option value="greens">–ó–µ–ª–µ–Ω—å —É –≥–æ—Ä—â–∏–∫—É</option>
            <option value="onion">–¶–∏–±—É–ª—è –Ω–∞ –ø–µ—Ä–æ</option>
            <option value="flowers_long">–ö–≤—ñ—Ç–∏ (–¥–æ–≤–≥–∏–π —Å—Ç–∞—Ä—Ç: –µ—É—Å—Ç–æ–º–∞/–±–µ–≥–æ–Ω—ñ—è/–ø–µ–ª–∞—Ä–≥–æ–Ω—ñ—è)</option>
            <option value="other">–Ü–Ω—à–µ (–∑–∞–≥–∞–ª—å–Ω–æ)</option>
          </select>

          <label class="small" style="display:block; margin-top:10px;">–ö–æ–ª–∏?</label>
          <input id="sowDate" type="date" style="width:100%; margin-top:6px; padding:10px 12px; border-radius:14px; border:1px solid var(--line); background:rgba(255,255,255,.03); color:var(--text);" />

          <label class="small" style="display:block; margin-top:10px;">–ù–æ—Ç–∞—Ç–∫–∞ (–Ω–µ–æ–±–æ–≤ º—è–∑–∫–æ–≤–æ)</label>
          <input id="sowNote" placeholder="–ù–∞–ø—Ä., ¬´–ø–µ—Ç—Ä—É—à–∫–∞ –≤ –º–∏—Å—Ü—ñ¬ª" style="width:100%; margin-top:6px; padding:10px 12px; border-radius:14px; border:1px solid var(--line); background:rgba(255,255,255,.03); color:var(--text);" />

          <div class="btnRow" style="margin-top:12px;">
            <button class="primary" id="btnSaveSowing">‚ûï –î–æ–¥–∞—Ç–∏</button>
            <button id="btnClearAll">üßπ –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å–µ</button>
          </div>

          <div class="small">–î–æ–¥–∞—Ç–æ–∫ –ø—ñ–¥–∫–∞–∂–µ ‚Äú–∫–æ–ª–∏ –≥–ª—è–Ω—É—Ç–∏/–ø–æ–ª–∏—Ç–∏‚Äù –º‚Äô—è–∫–æ ‚Äî –±–µ–∑ —Ç–∏—Å–∫—É üôÇ</div>
        </div>
      </div>
    </div>
  </section>
<nav>
  <a href="#" data-go="today" class="active">–°—å–æ–≥–æ–¥–Ω—ñ</a>
  <a href="#" data-go="sowings">–ú–æ—ó –ø–æ—Å—ñ–≤–∏</a>
  <a href="#" data-go="zones">–ó–æ–Ω–∏</a>
  <a href="#" data-go="calendar">–ö–∞–ª–µ–Ω–¥–∞—Ä</a>
</nav>

  <!-- CALENDAR (simple) -->
  <section class="view" id="view-calendar">
    <div class="grid">
      <div class="card">
        <div class="h">
          <h2>–ö–∞–ª–µ–Ω–¥–∞—Ä</h2>
          <span class="tag">–¥–µ–º–æ</span>
        </div>
        <div class="section">
          <div class="small">–¢—É—Ç –±—É–¥–µ –º—ñ—Å—è—Ü—å/—Ç–∏–∂–¥–µ–Ω—å. –£ –¥–µ–º–æ ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–π ‚Äú–ø–ª–∞–Ω-—ñ–¥–µ—ó‚Äù –Ω–∞ –Ω–∞–π–±–ª–∏–∂—á—ñ –¥–Ω—ñ.</div>
          <div class="list" id="calendarList"></div>
        </div>
      </div>
    </div>
  </section>

 <nav>
  <a href="#" data-go="today" class="active">–°—å–æ–≥–æ–¥–Ω—ñ</a>
  <a href="#" data-go="sowings">–ú–æ—ó –ø–æ—Å—ñ–≤–∏</a>
  <a href="#" data-go="zones">–ó–æ–Ω–∏</a>
  <a href="#" data-go="calendar">–ö–∞–ª–µ–Ω–¥–∞—Ä</a>
</nav>

</div>

<script>
  // --- utilities
  const $ = (id) => document.getElementById(id);
  const pad = (n) => String(n).padStart(2, "0");
  const isoDate = (d) => `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
  const uaDate = (d) => d.toLocaleDateString("uk-UA", { year:"numeric", month:"long", day:"numeric" });

  // --- seed daily content (January demo; can expand later)
  const daily = {
    // keys: YYYY-MM-DD
    // For demo, we provide for a few days; if missing, fallback logic kicks in.
  };

  function fallbackDaily(d){
    // Gentle, but with actionable options.
    const m = d.getMonth(); // 0=Jan
    if (m === 0) { // January
      return {
        easy: [
          "–ì–ª—è–Ω—É—Ç–∏, —á–∏ –Ω–µ —Ç—è–≥–Ω–µ —Ö–æ–ª–æ–¥–æ–º –∑ –≤—ñ–∫–Ω–∞ (—Ä–æ–∑—Å–∞–¥–∞ —Ü–µ –Ω–µ –ª—é–±–∏—Ç—å üòÖ)",
          "–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, –¥–µ –±—É–¥–µ —Å—Ç–æ—è—Ç–∏ —Ä–æ–∑—Å–∞–¥–∞: —Å–≤—ñ—Ç–ª–æ + —Ç–µ–ø–ª–æ",
          "–ó—Ä–æ–±–∏—Ç–∏ –º—ñ–Ω—ñ-—Ä–µ–≤—ñ–∑—ñ—é –Ω–∞—Å—ñ–Ω–Ω—è (—â–æ —î, —â–æ –¥–æ–∫—É–ø–∏—Ç–∏)"
        ],
        do: [
          "–ü–æ—Å–∞–¥–∏—Ç–∏ —Ü–∏–±—É–ª—é –Ω–∞ –ø–µ—Ä–æ (—à–≤–∏–¥–∫–∏–π –∫–∞–π—Ñ –±–µ–∑ —Ä–∏–∑–∏–∫—É)",
          "–ü–æ—Å—ñ—è—Ç–∏ –º—ñ–∫—Ä–æ–∑–µ–ª–µ–Ω—å (—Ä–µ–¥–∏—Å/–≥—ñ—Ä—á–∏—Ü—è/–≥–æ—Ä–æ—Ö) ‚Äî —Ü–µ —Ä–µ–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ",
          "–ü–æ—Å—ñ—è—Ç–∏ –∑–µ–ª–µ–Ω—å —É –≥–æ—Ä—â–∏–∫ (–∫—Ä—ñ–ø/–ø–µ—Ç—Ä—É—à–∫–∞/—Å–∞–ª–∞—Ç) ‚Äî –¥–ª—è –Ω–∞—Å—Ç—Ä–æ—é"
        ],
        sow: [
          "–Ø–∫—â–æ –¥—É–∂–µ —Ö–æ—á–µ—Ç—å—Å—è: –∫–≤—ñ—Ç–∏ –∑ –¥–æ–≤–≥–∏–º —Å—Ç–∞—Ä—Ç–æ–º (–µ—É—Å—Ç–æ–º–∞/–±–µ–≥–æ–Ω—ñ—è/–ø–µ–ª–∞—Ä–≥–æ–Ω—ñ—è)",
          "–ê–±–æ ‚Äú–∫–≤—ñ—Ç–∏ (–∑–∞–≥–∞–ª—å–Ω–æ)‚Äù ‚Äî —ñ –ø–æ—Ç—ñ–º –≤–∏—Ä—ñ—à–∏—à —Ç–æ—á–Ω—ñ—à–µ",
          "–ì–æ–ª–æ–≤–Ω–µ: —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–∞ –≤–æ–ª–æ–≥–∞, –±–µ–∑ –±–æ–ª–æ—Ç–∞ üôÇ"
        ],
        tip: "–Ø–∫—â–æ —Ç–∏ —â–µ –Ω–µ –∑–Ω–∞—î—à, —á–æ–≥–æ —Ö–æ—á–µ—à ‚Äî —Ü–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –û–±–µ—Ä–∏ –æ–¥–∏–Ω –º–∞–ª–µ–Ω—å–∫–∏–π –∫—Ä–æ–∫, —ñ —Ç–∏ –≤–∂–µ –≤ –ø—Ä–æ—Ü–µ—Å—ñ üåø"
      };
    }
    // Other months later
    return {
      easy:["–õ–µ–≥–∫–∏–π –æ–≥–ª—è–¥ —Ä–æ—Å–ª–∏–Ω —ñ –ø—Ä–æ—Å—Ç–æ—Ä—É."],
      do:["–©–æ—Å—å –º–∞–ª–µ–Ω—å–∫–µ, —â–æ –¥–∞—î –≤—ñ–¥—á—É—Ç—Ç—è —Ä—É—Ö—É."],
      sow:["–©–æ—Å—å –±–µ–∑–ø–µ—á–Ω–µ –¥–ª—è —Å—Ç–∞—Ä—Ç—É."],
      tip:"–¢–∏ –º–æ–ª–æ–¥–µ—Ü—å, —â–æ –ø–æ–≤–µ—Ä–Ω—É–ª–∞—Å—å –¥–æ —Ü—å–æ–≥–æ üå±"
    };
  }

  function setTodayContent(){
    const now = new Date();
    $("todayStr").textContent = uaDate(now);
    const key = isoDate(now);
    const content = daily[key] || fallbackDaily(now);

    const fill = (ul, arr) => {
      ul.innerHTML = "";
      for (const t of arr) {
        const li = document.createElement("li");
        li.textContent = t;
        ul.appendChild(li);
      }
    };

    fill($("easyList"), content.easy);
    fill($("doList"), content.do);
    fill($("sowList"), content.sow);
    $("tipBox").textContent = "üí° " + content.tip;

    renderCalendarDemo(now);
  }

  // --- simple sowing tracker + soft reminders
  const STORAGE_KEY = "my_garden_sowings_v1";
  const DONE_KEY = "my_garden_done_v1";

  function loadSowings(){
    try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]"); }
    catch { return []; }
  }
  function saveSowings(arr){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
  }
  // --- zones (beds/garden/flowers)
  const ZONES_KEY = "my_garden_zones_v1";

  function loadZones(){
    try { return JSON.parse(localStorage.getItem(ZONES_KEY) || "[]"); }
    catch { return []; }
  }
  function saveZones(arr){
    localStorage.setItem(ZONES_KEY, JSON.stringify(arr));
  }

  function zoneTypeTitle(t){
    switch(t){
      case "high_bed": return "–í–∏—Å–æ–∫–∞ –≥—Ä—è–¥–∫–∞";
      case "garden": return "–ì–æ—Ä–æ–¥";
      case "flowers": return "–ö–≤—ñ—Ç–Ω–∏–∫/–ø–æ–ª–µ";
      default: return "–ó–æ–Ω–∞";
    }
  }
  function cropTitle(c){
    switch(c){
      case "strawberry": return "–ü–æ–ª—É–Ω–∏—Ü—è";
      case "garlic": return "–ß–∞—Å–Ω–∏–∫";
      case "flowers_general": return "–ö–≤—ñ—Ç–∏";
      default: return "–Ü–Ω—à–µ";
    }
  }

  function zoneSoftTips(zone, now){
    // very gentle, month-based starter hints
    const m = now.getMonth(); // 0=Jan
    const tips = [];
    if (zone.crop === "strawberry"){
      if (m === 0 || m === 1) { // Jan-Feb
        tips.push("–Ø–∫—â–æ –±—É–¥–µ –Ω–∞—Å—Ç—Ä—ñ–π ‚Äî –≥–ª—è–Ω—å, —á–∏ –Ω–µ –æ–≥–æ–ª–∏–ª–∏—Å—å –∫–æ—Ä–µ–Ω—ñ –ø—ñ—Å–ª—è –≤—ñ—Ç—Ä—É/–≤—ñ–¥–ª–∏–≥.");
        tips.push("–Ø–∫—â–æ “ë—Ä—É–Ω—Ç –º–æ–∫—Ä–∏–π —ñ –≤–∞–∂–∫–∏–π ‚Äî –∫—Ä–∞—â–µ –Ω–µ —á—ñ–ø–∞—Ç–∏, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –º—É–ª—å—á—É/—É–∫—Ä–∏—Ç—Ç—è.");
        tips.push("–Ø–∫—â–æ –±–µ–∑ —Å–Ω—ñ–≥—É –π –º–æ—Ä–æ–∑–Ω–æ ‚Äî –ª–µ–≥–∫–µ —É–∫—Ä–∏—Ç—Ç—è/–º—É–ª—å—á–∞ –º–æ–∂–µ –±—É—Ç–∏ –¥–æ—Ä–µ—á–Ω–æ—é.");
      } else if (m === 2) { // Mar
        tips.push("–Ø–∫—â–æ –ø–æ—Ç–µ–ø–ª—ñ–ª–æ ‚Äî –º–æ–∂–Ω–∞ –ø–æ—Ç—Ä–æ—Ö—É –ø—Ä–∏–±—Ä–∞—Ç–∏ —Å—É—Ö–µ –ª–∏—Å—Ç—è (–±–µ–∑ —Ñ–∞–Ω–∞—Ç–∏–∑–º—É).");
        tips.push("–Ø–∫—â–æ —î —á–∞—Å ‚Äî –æ–≥–ª—è–¥ –Ω–∞ –ø—ñ–¥–≥–Ω–∏–≤–∞–Ω–Ω—è, –ø—Ä–æ–≤—ñ—Ç—Ä–∏—Ç–∏ –ø–æ—Å–∞–¥–∫–∏.");
      } else if (m === 3) { // Apr
        tips.push("–Ø–∫—â–æ –∑–µ–º–ª—è –ø—ñ–¥—Å–æ—Ö–ª–∞ ‚Äî –º‚Äô—è–∫–µ –ø—ñ–¥–∂–∏–≤–ª–µ–Ω–Ω—è (–∑–∞ –±–∞–∂–∞–Ω–Ω—è–º) —ñ —Ä–æ–∑–ø—É—à–∏—Ç–∏ –º—ñ–∂—Ä—è–¥–¥—è.");
        tips.push("–Ø–∫—â–æ —Ö–æ—á–µ—Ç—å—Å—è ‚Äî –ø—Ä–æ—Ñ—ñ–ª–∞–∫—Ç–∏—á–Ω–∏–π –æ–≥–ª—è–¥ —à–∫—ñ–¥–Ω–∏–∫—ñ–≤/—Ö–≤–æ—Ä–æ–±.");
      } else {
        tips.push("–Ø–∫—â–æ –±—É–¥–µ –Ω–∞—Å—Ç—Ä—ñ–π ‚Äî –ª–µ–≥–∫–∏–π –æ–≥–ª—è–¥ —ñ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤–æ–ª–æ–≥–∏ –±–µ–∑ –ø–µ—Ä–µ–ª–∏–≤—É üôÇ");
      }
    } else if (zone.crop === "garlic"){
      tips.push("–Ø–∫—â–æ –±—É–¥–µ –Ω–∞—Å—Ç—Ä—ñ–π ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä, —á–∏ –Ω–µ –≤–∏–ø–µ—Ä–ª–æ –∑—É–±—Ü—ñ –ø—ñ—Å–ª—è –º–æ—Ä–æ–∑—É/–≤—ñ–¥–ª–∏–≥–∏.");
    } else if (zone.crop === "flowers_general"){
      tips.push("–Ø–∫—â–æ –±—É–¥–µ –Ω–∞—Å—Ç—Ä—ñ–π ‚Äî –æ–≥–ª—è–¥ –∑–∏–º—ñ–≤–ª—ñ/—É–∫—Ä–∏—Ç—Ç—è, –±–µ–∑ —Ä—ñ–∑–∫–∏—Ö —Ä—É—Ö—ñ–≤ üôÇ");
    } else {
      tips.push("–ú‚Äô—è–∫–∏–π –æ–≥–ª—è–¥: –≤–æ–ª–æ–≥–∞/—É–∫—Ä–∏—Ç—Ç—è/–ø–æ—Ä—è–¥–æ–∫ –Ω–∞ –∑–æ–Ω—ñ.");
    }
    return tips;
  }

  function renderZones(){
    const zones = loadZones();
    $("zoneCount").textContent = String(zones.length);
    $("emptyZones").style.display = zones.length ? "none" : "block";

    const list = $("zoneList");
    list.innerHTML = "";

    const now = new Date();

    for (const z of zones){
      const div = document.createElement("div");
      div.className = "item";
      const size = (z.len && z.wid) ? `${z.len}√ó${z.wid} –º` : "—Ä–æ–∑–º—ñ—Ä –Ω–µ –≤–∫–∞–∑–∞–Ω–æ";
      const crop = cropTitle(z.crop);
      const qty = z.qty ? `${z.qty}` : "‚Äî";

      const tips = zoneSoftTips(z, now).slice(0,2).map(t=>`<div class="meta">‚Ä¢ ${t}</div>`).join("");

      div.innerHTML = `
        <b>${z.name || zoneTypeTitle(z.type)}</b>
        <div class="meta">${zoneTypeTitle(z.type)} ‚Ä¢ ${size}</div>
        <div class="meta">${crop} ‚Ä¢ –∫—ñ–ª—å–∫—ñ—Å—Ç—å: ${qty}${z.note ? " ‚Ä¢ " + z.note : ""}</div>
        <div class="meta" style="margin-top:6px;">–ü—ñ–¥–∫–∞–∑–∫–∏ (–º‚Äô—è–∫–æ):</div>
        ${tips}
        <div class="btnRow" style="margin-top:10px;">
          <button data-zdel="${z.id}">üóë –í–∏–¥–∞–ª–∏—Ç–∏</button>
        </div>
      `;
      list.appendChild(div);
    }

    list.querySelectorAll("button[data-zdel]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const id = btn.getAttribute("data-zdel");
        saveZones(loadZones().filter(x=> x.id !== id));
        renderZones();
        renderZonesInToday();
      });
    });
  }

  function renderZonesInToday(){
    // show gentle zone tips inside "–ú‚Äô—è–∫—ñ –ø—ñ–¥–∫–∞–∑–∫–∏ –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ"
    const zones = loadZones();
    const now = new Date();

    // append zone tips to existing reminders box
    const box = $("softReminders");
    const no = $("noReminders");

    let added = 0;
    for (const z of zones){
      const tips = zoneSoftTips(z, now);
      if (!tips.length) continue;

      const div = document.createElement("div");
      div.className = "item";
      div.innerHTML = `
        <b>${z.name || zoneTypeTitle(z.type)} ‚Ä¢ ${cropTitle(z.crop)}</b>
        <div class="meta">${tips[0]}</div>
      `;
      box.appendChild(div);
      added++;
      if (added >= 3) break; // keep it light
    }

    // if there are no sowings AND no zones, show empty message
    if (loadSowings().length === 0 && zones.length === 0){
      no.style.display = "block";
    } else {
      no.style.display = "none";
    }
  }

  function wireZonesForm(){
    $("btnSaveZone").addEventListener("click", ()=>{
      const z = {
        id: String(Date.now()) + Math.random().toString(16).slice(2),
        type: $("zoneType").value,
        name: $("zoneName").value.trim(),
        len: $("zoneLen").value.trim(),
        wid: $("zoneWid").value.trim(),
        crop: $("zoneCrop").value,
        qty: $("zoneCountInput").value.trim(),
        note: $("zoneNote").value.trim()
      };
      const zones = loadZones();
      zones.push(z);
      saveZones(zones);

      $("zoneName").value = "";
      $("zoneLen").value = "";
      $("zoneWid").value = "";
      $("zoneCountInput").value = "";
      $("zoneNote").value = "";

      renderZones();
      renderZonesInToday();
      go("zones");
    });

    // one-click demo for your strawberry bed 2√ó1, 24 bushes
    $("btnAddStrawberryDemo").addEventListener("click", ()=>{
      const zones = loadZones();
      zones.push({
        id: String(Date.now()) + Math.random().toString(16).slice(2),
        type: "high_bed",
        name: "–í–∏—Å–æ–∫–∞ –≥—Ä—è–¥–∫–∞ ‚Ññ1",
        len: "2",
        wid: "1",
        crop: "strawberry",
        qty: "24",
        note: "–ø–µ—Ä–µ—Å–∞–¥–∏–ª–∞ –≤–æ—Å–µ–Ω–∏"
      });
      saveZones(zones);
      renderZones();
      renderZonesInToday();
      go("zones");
    });
  }

  function typeMeta(type){
    switch(type){
      case "microgreens":
        return { title:"–ú—ñ–∫—Ä–æ–∑–µ–ª–µ–Ω—å", checkDays:[1,3,6], waterHint:"–õ–µ–≥–∫–∞ –≤–æ–ª–æ–≥–∞ —â–æ–¥–Ω—è/—á–µ—Ä–µ–∑ –¥–µ–Ω—å, –±–µ–∑ –±–æ–ª–æ—Ç–∞." };
      case "greens":
        return { title:"–ó–µ–ª–µ–Ω—å —É –≥–æ—Ä—â–∏–∫—É", checkDays:[2,4,7], waterHint:"–ü–µ—Ä–µ–≤—ñ—Ä—è–π –≤–µ—Ä—Ö–Ω—ñ–π —à–∞—Ä: –ø—ñ–¥—Å–æ—Ö ‚Äî –∑–ª–µ–≥–∫–∞ –ø–æ–ª–∏–π." };
      case "onion":
        return { title:"–¶–∏–±—É–ª—è –Ω–∞ –ø–µ—Ä–æ", checkDays:[2,5,8], waterHint:"–¢—Ä–∏–º–∞–π –ø–æ–º—ñ—Ä–Ω–æ –≤–æ–ª–æ–≥–∏–º, –∞–ª–µ –Ω–µ –∑–∞–ª–∏–≤–∞–π." };
      case "flowers_long":
        return { title:"–ö–≤—ñ—Ç–∏ (–¥–æ–≤–≥–∏–π —Å—Ç–∞—Ä—Ç)", checkDays:[2,5,10,14], waterHint:"–ì–æ–ª–æ–≤–Ω–µ ‚Äî —Ä—ñ–≤–Ω–∞ –≤–æ–ª–æ–≥–∞ + —Å–≤—ñ—Ç–ª–æ. –ü–µ—Ä–µ–ª–∏–≤ ‚Äî –≤–æ—Ä–æ–≥ ‚Ññ1 üòÖ" };
      default:
        return { title:"–Ü–Ω—à–µ", checkDays:[2,5,9], waterHint:"–ú‚Äô—è–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–æ–ª–æ–≥–∏ —Ç–∞ —Å–≤—ñ—Ç–ª–∞, –±–µ–∑ –ø–∞–Ω—ñ–∫–∏ üôÇ" };
    }
  }

  function computeSoftReminders(sowings){
    const now = new Date();
    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    const reminders = [];

    for (const s of sowings){
      const meta = typeMeta(s.type);
      const sd = new Date(s.date);
      const start = new Date(sd.getFullYear(), sd.getMonth(), sd.getDate());
      const diffDays = Math.round((today - start) / (1000*60*60*24));

      // If sowing date is in future, skip
      if (diffDays < 0) continue;

      // If today matches one of checkDays -> gentle reminder
      if (meta.checkDays.includes(diffDays)){
        reminders.push({
          id: s.id,
          title: meta.title,
          text: `–Ø–∫—â–æ –±—É–¥–µ –Ω–∞—Å—Ç—Ä—ñ–π ‚Äî –º–æ–∂–Ω–∞ –≥–ª—è–Ω—É—Ç–∏, —è–∫ —Ç–∞–º “ë—Ä—É–Ω—Ç (–¥–µ–Ω—å ${diffDays} –ø—ñ—Å–ª—è –ø–æ—Å—ñ–≤—É).`,
          note: s.note || "",
          hint: meta.waterHint
        });
      }
    }
    return reminders;
  }

  function renderSowings(){
    const sowings = loadSowings().sort((a,b)=> (a.date < b.date ? 1 : -1));
    const list = $("sowingList");
    list.innerHTML = "";

    $("sowCount").textContent = String(sowings.length);
    $("emptySowings").style.display = sowings.length ? "none" : "block";

    for (const s of sowings){
      const meta = typeMeta(s.type);
      const div = document.createElement("div");
      div.className = "item";
      const dateStr = new Date(s.date).toLocaleDateString("uk-UA", {year:"numeric",month:"short",day:"numeric"});
      div.innerHTML = `
        <b>${meta.title}</b>
        <div class="meta">–ü–æ—Å—ñ—è–Ω–æ/–ø–æ—Å–∞–¥–∂–µ–Ω–æ: ${dateStr}${s.note ? " ‚Ä¢ " + s.note : ""}</div>
        <div class="btnRow" style="margin-top:10px;">
          <button data-del="${s.id}">üóë –í–∏–¥–∞–ª–∏—Ç–∏</button>
        </div>
      `;
      list.appendChild(div);
    }

    // delete handlers
    list.querySelectorAll("button[data-del]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const id = btn.getAttribute("data-del");
        const next = loadSowings().filter(x=> x.id !== id);
        saveSowings(next);
        renderAll();
      });
    });
  }

  function renderSoftReminders(){
    const sowings = loadSowings();
    const reminders = computeSoftReminders(sowings);
    const box = $("softReminders");
    box.innerHTML = "";

    $("noReminders").style.display = reminders.length ? "none" : "block";

    for (const r of reminders){
      const div = document.createElement("div");
      div.className = "item";
      div.innerHTML = `
        <b>${r.title}</b>
        <div class="meta">${r.text}</div>
        ${r.note ? `<div class="meta">–ù–æ—Ç–∞—Ç–∫–∞: ${r.note}</div>` : ""}
        <div class="meta">–ü—ñ–¥–∫–∞–∑–∫–∞: ${r.hint}</div>
      `;
      box.appendChild(div);
    }
  }

  // --- Done button (gentle)
  function loadDone(){
    try { return JSON.parse(localStorage.getItem(DONE_KEY) || "{}"); }
    catch { return {}; }
  }
  function saveDone(obj){ localStorage.setItem(DONE_KEY, JSON.stringify(obj)); }

  function wireDone(){
    const now = new Date();
    const key = isoDate(now);
    const done = loadDone();
    const hint = $("doneHint");

    function render(){
      hint.textContent = done[key]
        ? "–°—É–ø–µ—Ä üôÇ –Ø –≤—ñ–¥–º—ñ—Ç–∏–ª–∞, —â–æ —Å—å–æ–≥–æ–¥–Ω—ñ —Ç–∏ —â–æ—Å—å –∑—Ä–æ–±–∏–ª–∞. –Ø–∫—â–æ –∑–∞–≤—Ç—Ä–∞ –±—É–¥–µ –≤–∞–∂–∫–æ ‚Äî –Ω—ñ—á–æ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ."
        : "–ú–æ–∂–µ—à –≤—ñ–¥–º—ñ—Ç–∏—Ç–∏, —è–∫—â–æ —Å—å–æ–≥–æ–¥–Ω—ñ —Ö–æ—á —Ç—Ä–æ—à–∫–∏ —â–æ—Å—å –∑—Ä–æ–±–∏–ª–∞. –ê —è–∫—â–æ –Ω—ñ ‚Äî —Ç–µ–∂ –æ–∫ ü§ç";
    }
    render();

    $("btnDone").addEventListener("click", ()=>{
      done[key] = true;
      saveDone(done);
      render();
    });
  }

  // --- Add sowing quick button
  function wireSowingForm(){
    const now = new Date();
    $("sowDate").value = isoDate(now);

    $("btnSaveSowing").addEventListener("click", ()=>{
      const type = $("sowType").value;
      const date = $("sowDate").value || isoDate(new Date());
      const note = $("sowNote").value.trim();

      const sowings = loadSowings();
      sowings.push({
        id: String(Date.now()) + Math.random().toString(16).slice(2),
        type, date, note
      });
      saveSowings(sowings);

      $("sowNote").value = "";
      renderAll();
      go("sowings");
    });

    $("btnClearAll").addEventListener("click", ()=>{
      if (confirm("–¢–æ—á–Ω–æ –æ—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –ø–æ—Å—ñ–≤–∏? –¶–µ —Ç—ñ–ª—å–∫–∏ –¥–µ–º–æ-–¥–∞–Ω—ñ üôÇ")){
        saveSowings([]);
        renderAll();
      }
    });

    $("btnAddSowing").addEventListener("click", ()=>{
      go("sowings");
      // scroll to form gently
      window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
    });
  }

  // --- calendar demo list
  function renderCalendarDemo(now){
    const list = $("calendarList");
    list.innerHTML = "";
    for (let i=0;i<7;i++){
      const d = new Date(now.getFullYear(), now.getMonth(), now.getDate()+i);
      const dateStr = d.toLocaleDateString("uk-UA", { weekday:"short", day:"2-digit", month:"2-digit" });
      const c = daily[isoDate(d)] || fallbackDaily(d);
      const div = document.createElement("div");
      div.className = "item";
      div.innerHTML = `
        <b>${dateStr}</b>
        <div class="meta">üü¢ ${c.easy[0]}</div>
        <div class="meta">üü° ${c.do[0]}</div>
        <div class="meta">üîµ ${c.sow[0]}</div>
      `;
      list.appendChild(div);
    }
  }

  // --- navigation
  function go(where){
    document.querySelectorAll("nav a").forEach(a=> a.classList.remove("active"));
    document.querySelectorAll(".view").forEach(v=> v.classList.remove("active"));

    document.querySelector(`nav a[data-go="${where}"]`).classList.add("active");
    $("view-" + where).classList.add("active");
  }

  function wireNav(){
    document.querySelectorAll("nav a").forEach(a=>{
      a.addEventListener("click", (e)=>{
        e.preventDefault();
        go(a.getAttribute("data-go"));
      });
    });
  }

function renderAll(){
  renderSowings();
  renderSoftReminders();
  renderZones();
  // renderZonesInToday is called after renderSoftReminders to append tips
  renderZonesInToday();
}


  // --- init
  setTodayContent();
  wireNav();
  wireDone();
  wireSowingForm();
  wireZonesForm();
  renderAll();

  // Register service worker if present (added later)
  if ("serviceWorker" in navigator){
    navigator.serviceWorker.register("./sw.js").catch(()=>{});
  }
</script>
</body>
</html>
