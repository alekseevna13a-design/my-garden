<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#2f6f3e" />
  <title>–ú—ñ–π –∫–∞–ª–µ–Ω–¥–∞—Ä —Å–∞–¥—ñ–≤–Ω–∏–∫–∞</title>

  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="apple-touch-icon" href="icon-192.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />

  <style>
    :root{
      --bg:#0f1a12; --card:#162319; --text:#e9f5ec; --muted:#b7d7bf;
      --accent:#5bd07a; --accent2:#2f6f3e; --line:rgba(255,255,255,.10);
      --shadow:0 10px 25px rgba(0,0,0,.35); --r:18px;
      text-rendering:optimizeLegibility; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    body{ margin:0; background:radial-gradient(1200px 800px at 20% 0%, #173322 0%, var(--bg) 55%); color:var(--text);
      font:16px/1.4 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,Arial,sans-serif;}
    .wrap{ max-width:720px; margin:0 auto; padding:18px 14px 44px;}
    header{ display:flex; align-items:flex-start; justify-content:space-between; gap:10px; margin-top:6px;}
    .title{ font-size:22px; font-weight:800; letter-spacing:.2px;}
    .sub{ color:var(--muted); font-size:13px; margin-top:4px;}
    .pill{ border:1px solid var(--line); background:rgba(255,255,255,.03); padding:8px 10px; border-radius:999px;
      font-size:12px; color:var(--muted); display:flex; align-items:center; gap:6px;}
    .grid{ display:grid; gap:12px; margin-top:14px;}
    .card{ background:linear-gradient(180deg, rgba(255,255,255,.04) 0%, rgba(255,255,255,.02) 100%);
      border:1px solid var(--line); border-radius:var(--r); box-shadow:var(--shadow); padding:14px;}
    .h{ display:flex; align-items:center; justify-content:space-between; gap:10px;}
    .h h2{ margin:0; font-size:16px;}
    .tag{ font-size:12px; color:var(--muted); border:1px solid var(--line); padding:4px 8px; border-radius:999px;}
    .section{ margin-top:10px; border-top:1px solid var(--line); padding-top:10px;}
    .choice{ margin-top:10px;}
    .choiceTitle{ display:flex; align-items:center; justify-content:space-between; gap:8px;}
    .choiceTitle b{ font-size:14px;}
    .time{ color:var(--muted); font-size:12px;}
    ul{ margin:8px 0 0 18px; padding:0;}
    li{ margin:6px 0;}
    .tip{ margin-top:12px; padding:10px 12px; border-radius:14px; background:rgba(91,208,122,.08);
      border:1px solid rgba(91,208,122,.22); color:#dff7e6;}
    .btnRow{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;}
    button{ appearance:none; border:1px solid var(--line); background:rgba(255,255,255,.03); color:var(--text);
      padding:10px 12px; border-radius:14px; font-weight:800;}
    button.primary{ border-color:rgba(91,208,122,.35); background:rgba(91,208,122,.16);}
    button:active{ transform:translateY(1px);}
    .small{ font-size:12px; color:var(--muted); margin-top:10px;}
    nav{ position:sticky; bottom:0; margin-top:14px; background:rgba(15,26,18,.75); backdrop-filter:blur(10px);
      border:1px solid var(--line); border-radius:18px; padding:10px; display:flex; gap:8px; justify-content:space-between;}
    nav a{ flex:1; text-align:center; text-decoration:none; color:var(--muted); padding:10px 8px; border-radius:14px;
      border:1px solid transparent; font-weight:800; font-size:13px;}
    nav a.active{ color:var(--text); background:rgba(255,255,255,.04); border-color:var(--line);}
    .view{ display:none;}
    .view.active{ display:block;}
    .list{ margin-top:10px; display:grid; gap:10px;}
    .item{ border:1px solid var(--line); border-radius:14px; padding:10px 12px; background:rgba(255,255,255,.02);}
    .item b{ display:block;}
    .item .meta{ color:var(--muted); font-size:12px; margin-top:4px;}
    .empty{ color:var(--muted); text-align:center; padding:16px 0;}
    select,input{ width:100%; margin-top:6px; padding:10px 12px; border-radius:14px; border:1px solid var(--line);
      background:rgba(255,255,255,.03); color:var(--text);}
    .row{ display:flex; gap:10px; }
    .row > *{ flex:1; }
  </style>
</head>

<body>
<div class="wrap">
  <header>
    <div>
      <div class="title">–ú—ñ–π –∫–∞–ª–µ–Ω–¥–∞—Ä —Å–∞–¥—ñ–≤–Ω–∏–∫–∞ üå±</div>
      <div class="sub">–ü–∞–≤–ª—ñ–≤–∫–∞, –í—ñ–Ω–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å ‚Ä¢ –º º—è–∫–∏–π —Ä–µ–∂–∏–º</div>
    </div>
    <div class="pill">üìÖ <span id="todayStr"></span></div>
  </header>

  <!-- TODAY -->
  <section class="view active" id="view-today">
    <div class="grid">
      <div class="card">
        <div class="h"><h2>–°—å–æ–≥–æ–¥–Ω—ñ</h2><span class="tag">–û–±–µ—Ä–∏ —Ä—ñ–≤–µ–Ω—å</span></div>

        <div class="choice">
          <div class="choiceTitle"><b>üü¢ –õ–µ–≥–∫–æ</b><span class="time">10‚Äì15 —Ö–≤</span></div>
          <ul id="easyList"></ul>
        </div>

        <div class="choice">
          <div class="choiceTitle"><b>üü° –•–æ—á—É —â–æ—Å—å –∑—Ä–æ–±–∏—Ç–∏</b><span class="time">15‚Äì30 —Ö–≤</span></div>
          <ul id="doList"></ul>
        </div>

        <div class="choice">
          <div class="choiceTitle"><b>üîµ –•–æ—á—É —Å—ñ—è—Ç–∏</b><span class="time">30‚Äì60 —Ö–≤</span></div>
          <ul id="sowList"></ul>
        </div>

        <div class="tip" id="tipBox"></div>

        <div class="btnRow">
          <button class="primary" id="btnDone">‚úî –Ø —â–æ—Å—å –∑—Ä–æ–±–∏–ª–∞</button>
          <button id="btnAddSowing">‚ûï –Ø –ø–æ—Å—ñ—è–ª–∞ / –ø–æ—Å–∞–¥–∏–ª–∞</button>
        </div>
        <div class="small" id="doneHint"></div>
      </div>

      <div class="card">
        <div class="h"><h2>–ú‚Äô—è–∫—ñ –ø—ñ–¥–∫–∞–∑–∫–∏ –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ</h2><span class="tag">–ø–æ—Å—ñ–≤–∏ + –∑–æ–Ω–∏</span></div>
        <div class="list" id="softReminders"></div>
        <div class="empty" id="noReminders" style="display:none;">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–∏—Ö –ø–æ—Å—ñ–≤—ñ–≤/–∑–æ–Ω. –î–æ–¥–∞–π —â–æ—Å—å ‚Äî —ñ —è –ø—ñ–¥–∫–∞–∂—É üôÇ</div>
      </div>
    </div>
  </section>

  <!-- SOWINGS -->
  <section class="view" id="view-sowings">
    <div class="grid">
      <div class="card">
        <div class="h"><h2>–ú–æ—ó –ø–æ—Å—ñ–≤–∏</h2><span class="tag" id="sowCount">0</span></div>
        <div class="list" id="sowingList"></div>
        <div class="empty" id="emptySowings">–¢—É—Ç –∑‚Äô—è–≤–∏—Ç—å—Å—è —Å–ø–∏—Å–æ–∫, –∫–æ–ª–∏ —Ç–∏ –≤—ñ–¥–º—ñ—Ç–∏—à ‚Äú—è –ø–æ—Å—ñ—è–ª–∞ / –ø–æ—Å–∞–¥–∏–ª–∞‚Äù üåø</div>
      </div>

      <div class="card">
        <div class="h"><h2>–î–æ–¥–∞—Ç–∏ –ø–æ—Å—ñ–≤</h2><span class="tag">1 —Ö–≤</span></div>
        <div class="section">
          <label class="small">–©–æ —Ç–∏ –∑—Ä–æ–±–∏–ª–∞?</label>
          <select id="sowType">
            <option value="microgreens">–ú—ñ–∫—Ä–æ–∑–µ–ª–µ–Ω—å</option>
            <option value="greens">–ó–µ–ª–µ–Ω—å —É –≥–æ—Ä—â–∏–∫—É</option>
            <option value="onion">–¶–∏–±—É–ª—è –Ω–∞ –ø–µ—Ä–æ</option>
            <option value="flowers_long">–ö–≤—ñ—Ç–∏ (–¥–æ–≤–≥–∏–π —Å—Ç–∞—Ä—Ç: –µ—É—Å—Ç–æ–º–∞/–±–µ–≥–æ–Ω—ñ—è/–ø–µ–ª–∞—Ä–≥–æ–Ω—ñ—è)</option>
            <option value="other">–Ü–Ω—à–µ (–∑–∞–≥–∞–ª—å–Ω–æ)</option>
          </select>

          <label class="small" style="display:block; margin-top:10px;">–ö–æ–ª–∏?</label>
          <input id="sowDate" type="date" />

          <label class="small" style="display:block; margin-top:10px;">–ù–æ—Ç–∞—Ç–∫–∞ (–Ω–µ–æ–±–æ–≤ º—è–∑–∫–æ–≤–æ)</label>
          <input id="sowNote" placeholder="–ù–∞–ø—Ä., ¬´–ø–µ—Ç—Ä—É—à–∫–∞ –≤ –º–∏—Å—Ü—ñ¬ª" />

          <div class="btnRow" style="margin-top:12px;">
            <button class="primary" id="btnSaveSowing">‚ûï –î–æ–¥–∞—Ç–∏</button>
            <button id="btnClearAll">üßπ –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å–µ</button>
          </div>
          <div class="small">–ü—ñ–¥–∫–∞–∑–∫–∏ –º‚Äô—è–∫—ñ: ‚Äú—è–∫—â–æ –±—É–¥–µ –Ω–∞—Å—Ç—Ä—ñ–π‚Ä¶‚Äù –±–µ–∑ —Ç–∏—Å–∫—É ü§ç</div>
        </div>
      </div>
    </div>
  </section>

  <!-- ZONES -->
  <section class="view" id="view-zones">
    <div class="grid">
      <div class="card">
        <div class="h"><h2>–ú–æ—ó –∑–æ–Ω–∏</h2><span class="tag" id="zoneCount">0</span></div>
        <div class="list" id="zoneList"></div>
        <div class="empty" id="emptyZones">–î–æ–¥–∞–π –≥—Ä—è–¥–∫—É/–≥–æ—Ä–æ–¥/–∫–≤—ñ—Ç–Ω–∏–∫ ‚Äî —ñ —è –ø—ñ–¥–∫–∞–∂—É, —â–æ –º–æ–∂–Ω–∞ —Ä–æ–±–∏—Ç–∏ —Å–∞–º–µ —Ç–∞–º üôÇ</div>
      </div>

      <div class="card">
        <div class="h"><h2>–î–æ–¥–∞—Ç–∏ –∑–æ–Ω—É</h2><span class="tag">1 —Ö–≤</span></div>
        <div class="section">
          <label class="small">–¢–∏–ø</label>
          <select id="zoneType">
            <option value="high_bed">–í–∏—Å–æ–∫–∞ –≥—Ä—è–¥–∫–∞</option>
            <option value="garden">–ì–æ—Ä–æ–¥ (–¥—ñ–ª—è–Ω–∫–∞)</option>
            <option value="flowers">–ö–≤—ñ—Ç–Ω–∏–∫ / –ø–æ–ª–µ –∫–≤—ñ—Ç—ñ–≤</option>
          </select>

          <label class="small" style="display:block; margin-top:10px;">–ù–∞–∑–≤–∞</label>
          <input id="zoneName" placeholder="–ù–∞–ø—Ä., –í–∏—Å–æ–∫–∞ –≥—Ä—è–¥–∫–∞ ‚Ññ1" />

          <label class="small" style="display:block; margin-top:10px;">–†–æ–∑–º—ñ—Ä (–º)</label>
          <div class="row">
            <input id="zoneLen" inputmode="decimal" placeholder="–î–æ–≤–∂–∏–Ω–∞ (–Ω–∞–ø—Ä. 2)" />
            <input id="zoneWid" inputmode="decimal" placeholder="–®–∏—Ä–∏–Ω–∞ (–Ω–∞–ø—Ä. 1)" />
          </div>

          <label class="small" style="display:block; margin-top:10px;">–©–æ —Ä–æ—Å—Ç–µ</label>
          <select id="zoneCrop">
            <option value="strawberry">–ü–æ–ª—É–Ω–∏—Ü—è</option>
            <option value="garlic">–ß–∞—Å–Ω–∏–∫</option>
            <option value="flowers_general">–ö–≤—ñ—Ç–∏ (–∑–∞–≥–∞–ª—å–Ω–æ)</option>
            <option value="other">–Ü–Ω—à–µ</option>
          </select>

          <label class="small" style="display:block; margin-top:10px;">–ö—ñ–ª—å–∫—ñ—Å—Ç—å (–∫—É—â—ñ/—Ä–æ—Å–ª–∏–Ω–∏)</label>
          <input id="zoneQty" inputmode="numeric" placeholder="–ù–∞–ø—Ä., 24" />

          <label class="small" style="display:block; margin-top:10px;">–ù–æ—Ç–∞—Ç–∫–∞ (–Ω–µ–æ–±–æ–≤ º—è–∑–∫–æ–≤–æ)</label>
          <input id="zoneNote" placeholder="–ù–∞–ø—Ä., –ø–µ—Ä–µ—Å–∞–¥–∏–ª–∞ –≤–æ—Å–µ–Ω–∏" />

          <div class="btnRow" style="margin-top:12px;">
            <button class="primary" id="btnSaveZone">‚ûï –î–æ–¥–∞—Ç–∏ –∑–æ–Ω—É</button>
            <button id="btnAddStrawberry">üçì –î–æ–¥–∞—Ç–∏ –º–æ—é –ø–æ–ª—É–Ω–∏—Ü—é</button>
            <button id="btnClearZones">üßπ –û—á–∏—Å—Ç–∏—Ç–∏ –∑–æ–Ω–∏</button>
          </div>
          <div class="small">–ü—ñ–¥–∫–∞–∑–∫–∏ –±—É–¥—É—Ç—å –º‚Äô—è–∫—ñ: ‚Äú—è–∫—â–æ –±—É–¥–µ –Ω–∞—Å—Ç—Ä—ñ–π‚Ä¶‚Äù –±–µ–∑ —Ç–∏—Å–∫—É ü§ç</div>
        </div>
      </div>
    </div>
  </section>

  <!-- CALENDAR -->
  <section class="view" id="view-calendar">
    <div class="grid">
      <div class="card">
        <div class="h"><h2>–ö–∞–ª–µ–Ω–¥–∞—Ä</h2><span class="tag">–¥–µ–º–æ</span></div>
        <div class="section">
          <div class="small">–î–µ–º–æ ‚Äú–ø–ª–∞–Ω-—ñ–¥–µ—ó‚Äù –Ω–∞ –Ω–∞–π–±–ª–∏–∂—á—ñ 7 –¥–Ω—ñ–≤.</div>
          <div class="list" id="calendarList"></div>
        </div>
      </div>
    </div>
  </section>

  <nav>
    <a href="#" data-go="today" class="active">–°—å–æ–≥–æ–¥–Ω—ñ</a>
    <a href="#" data-go="sowings">–ú–æ—ó –ø–æ—Å—ñ–≤–∏</a>
    <a href="#" data-go="zones">–ó–æ–Ω–∏</a>
    <a href="#" data-go="calendar">–ö–∞–ª–µ–Ω–¥–∞—Ä</a>
  </nav>
</div>

<script>
  const $ = (id) => document.getElementById(id);
  const pad = (n) => String(n).padStart(2,"0");
  const isoDate = (d) => `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
  const uaDate = (d) => d.toLocaleDateString("uk-UA",{year:"numeric",month:"long",day:"numeric"});

  function fallbackDaily(d){
    const m=d.getMonth();
    if(m===0){ // January
      return {
        easy:[
          "–ì–ª—è–Ω—É—Ç–∏, —á–∏ –Ω–µ —Ç—è–≥–Ω–µ —Ö–æ–ª–æ–¥–æ–º –∑ –≤—ñ–∫–Ω–∞ (—Ä–æ–∑—Å–∞–¥–∞ —Ü—å–æ–≥–æ –Ω–µ –ª—é–±–∏—Ç—å üòÖ)",
          "–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, –¥–µ –±—É–¥–µ —Å—Ç–æ—è—Ç–∏ —Ä–æ–∑—Å–∞–¥–∞: —Å–≤—ñ—Ç–ª–æ + —Ç–µ–ø–ª–æ",
          "–ú—ñ–Ω—ñ-—Ä–µ–≤—ñ–∑—ñ—è –Ω–∞—Å—ñ–Ω–Ω—è: —â–æ —î, —â–æ –¥–æ–∫—É–ø–∏—Ç–∏"
        ],
        do:[
          "–ü–æ—Å–∞–¥–∏—Ç–∏ —Ü–∏–±—É–ª—é –Ω–∞ –ø–µ—Ä–æ (—à–≤–∏–¥–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ —Ä–∏–∑–∏–∫—É)",
          "–ü–æ—Å—ñ—è—Ç–∏ –º—ñ–∫—Ä–æ–∑–µ–ª–µ–Ω—å (—Ä–µ–¥–∏—Å/–≥—ñ—Ä—á–∏—Ü—è/–≥–æ—Ä–æ—Ö) ‚Äî —Ä–µ–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ",
          "–ü–æ—Å—ñ—è—Ç–∏ –∑–µ–ª–µ–Ω—å —É –≥–æ—Ä—â–∏–∫ (–∫—Ä—ñ–ø/–ø–µ—Ç—Ä—É—à–∫–∞/—Å–∞–ª–∞—Ç) ‚Äî –¥–ª—è –Ω–∞—Å—Ç—Ä–æ—é"
        ],
        sow:[
          "–Ø–∫—â–æ –¥—É–∂–µ —Ö–æ—á–µ—Ç—å—Å—è: –∫–≤—ñ—Ç–∏ –∑ –¥–æ–≤–≥–∏–º —Å—Ç–∞—Ä—Ç–æ–º (–µ—É—Å—Ç–æ–º–∞/–±–µ–≥–æ–Ω—ñ—è/–ø–µ–ª–∞—Ä–≥–æ–Ω—ñ—è)",
          "–ê–±–æ ‚Äú–∫–≤—ñ—Ç–∏ (–∑–∞–≥–∞–ª—å–Ω–æ)‚Äù ‚Äî —ñ –ø–æ—Ç—ñ–º –≤–∏—Ä—ñ—à–∏—à —Ç–æ—á–Ω—ñ—à–µ",
          "–ì–æ–ª–æ–≤–Ω–µ: —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–∞ –≤–æ–ª–æ–≥–∞, –±–µ–∑ –±–æ–ª–æ—Ç–∞ üôÇ"
        ],
        tip:"–Ø–∫—â–æ —Ç–∏ —â–µ –Ω–µ –∑–Ω–∞—î—à, —á–æ–≥–æ —Ö–æ—á–µ—à ‚Äî —Ü–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –û–±–µ—Ä–∏ –æ–¥–∏–Ω –º–∞–ª–µ–Ω—å–∫–∏–π –∫—Ä–æ–∫, —ñ —Ç–∏ –≤–∂–µ –≤ –ø—Ä–æ—Ü–µ—Å—ñ üåø"
      };
    }
    return {easy:["–õ–µ–≥–∫–∏–π –æ–≥–ª—è–¥ –ø—Ä–æ—Å—Ç–æ—Ä—É."],do:["–©–æ—Å—å –º–∞–ª–µ–Ω—å–∫–µ –¥–ª—è —Ä—É—Ö—É."],sow:["–©–æ—Å—å –±–µ–∑–ø–µ—á–Ω–µ –¥–ª—è —Å—Ç–∞—Ä—Ç—É."],tip:"–¢–∏ –º–æ–ª–æ–¥–µ—Ü—å, —â–æ –ø–æ–≤–µ—Ä–Ω—É–ª–∞—Å—å üå±"};
  }

  function setTodayContent(){
    const now=new Date();
    $("todayStr").textContent=uaDate(now);
    const c=fallbackDaily(now);
    const fill=(ul,arr)=>{ ul.innerHTML=""; arr.forEach(t=>{ const li=document.createElement("li"); li.textContent=t; ul.appendChild(li);});};
    fill($("easyList"),c.easy); fill($("doList"),c.do); fill($("sowList"),c.sow);
    $("tipBox").textContent="üí° "+c.tip;
    renderCalendarDemo(now);
  }

  // --- sowings
  const STORAGE_KEY="my_garden_sowings_v1";
  function loadSowings(){ try{return JSON.parse(localStorage.getItem(STORAGE_KEY)||"[]");}catch{return[];} }
  function saveSowings(a){ localStorage.setItem(STORAGE_KEY,JSON.stringify(a)); }

  function typeMeta(type){
    switch(type){
      case "microgreens": return {title:"–ú—ñ–∫—Ä–æ–∑–µ–ª–µ–Ω—å", checkDays:[1,3,6], hint:"–õ–µ–≥–∫–∞ –≤–æ–ª–æ–≥–∞ —â–æ–¥–Ω—è/—á–µ—Ä–µ–∑ –¥–µ–Ω—å, –±–µ–∑ –±–æ–ª–æ—Ç–∞."};
      case "greens": return {title:"–ó–µ–ª–µ–Ω—å —É –≥–æ—Ä—â–∏–∫—É", checkDays:[2,4,7], hint:"–ü—ñ–¥—Å–æ—Ö –≤–µ—Ä—Ö–Ω—ñ–π —à–∞—Ä ‚Äî –∑–ª–µ–≥–∫–∞ –ø–æ–ª–∏–π."};
      case "onion": return {title:"–¶–∏–±—É–ª—è –Ω–∞ –ø–µ—Ä–æ", checkDays:[2,5,8], hint:"–ü–æ–º—ñ—Ä–Ω–∞ –≤–æ–ª–æ–≥–∞, –Ω–µ –∑–∞–ª–∏–≤–∞–π."};
      case "flowers_long": return {title:"–ö–≤—ñ—Ç–∏ (–¥–æ–≤–≥–∏–π —Å—Ç–∞—Ä—Ç)", checkDays:[2,5,10,14], hint:"–†—ñ–≤–Ω–∞ –≤–æ–ª–æ–≥–∞ + —Å–≤—ñ—Ç–ª–æ. –ü–µ—Ä–µ–ª–∏–≤ ‚Äî –≤–æ—Ä–æ–≥ ‚Ññ1 üòÖ"};
      default: return {title:"–Ü–Ω—à–µ", checkDays:[2,5,9], hint:"–ú‚Äô—è–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–æ–ª–æ–≥–∏ —Ç–∞ —Å–≤—ñ—Ç–ª–∞ üôÇ"};
    }
  }

  function computeSowingReminders(){
    const now=new Date();
    const today=new Date(now.getFullYear(),now.getMonth(),now.getDate());
    const out=[];
    for(const s of loadSowings()){
      const meta=typeMeta(s.type);
      const sd=new Date(s.date);
      const start=new Date(sd.getFullYear(),sd.getMonth(),sd.getDate());
      const diff=Math.round((today-start)/(1000*60*60*24));
      if(diff<0) continue;
      if(meta.checkDays.includes(diff)){
        out.push({title:meta.title, text:`–Ø–∫—â–æ –±—É–¥–µ –Ω–∞—Å—Ç—Ä—ñ–π ‚Äî –º–æ–∂–Ω–∞ –≥–ª—è–Ω—É—Ç–∏ “ë—Ä—É–Ω—Ç (–¥–µ–Ω—å ${diff} –ø—ñ—Å–ª—è –ø–æ—Å—ñ–≤—É).`, note:s.note||"", hint:meta.hint});
      }
    }
    return out;
  }

  function renderSowings(){
    const sow=loadSowings().sort((a,b)=>a.date<b.date?1:-1);
    $("sowCount").textContent=String(sow.length);
    $("emptySowings").style.display=sow.length?"none":"block";
    const list=$("sowingList"); list.innerHTML="";
    for(const s of sow){
      const meta=typeMeta(s.type);
      const d=new Date(s.date).toLocaleDateString("uk-UA",{year:"numeric",month:"short",day:"numeric"});
      const div=document.createElement("div"); div.className="item";
      div.innerHTML=`<b>${meta.title}</b><div class="meta">–ü–æ—Å—ñ—è–Ω–æ/–ø–æ—Å–∞–¥–∂–µ–Ω–æ: ${d}${s.note?" ‚Ä¢ "+s.note:""}</div>
        <div class="btnRow" style="margin-top:10px;"><button data-del="${s.id}">üóë –í–∏–¥–∞–ª–∏—Ç–∏</button></div>`;
      list.appendChild(div);
    }
    list.querySelectorAll("button[data-del]").forEach(btn=>{
      btn.addEventListener("click",()=>{ const id=btn.getAttribute("data-del"); saveSowings(loadSowings().filter(x=>x.id!==id)); renderAll();});
    });
  }

  // --- zones
  const ZONES_KEY="my_garden_zones_v1";
  function loadZones(){ try{return JSON.parse(localStorage.getItem(ZONES_KEY)||"[]");}catch{return[];} }
  function saveZones(a){ localStorage.setItem(ZONES_KEY,JSON.stringify(a)); }

  const zoneTypeTitle=(t)=>t==="high_bed"?"–í–∏—Å–æ–∫–∞ –≥—Ä—è–¥–∫–∞":t==="garden"?"–ì–æ—Ä–æ–¥":t==="flowers"?"–ö–≤—ñ—Ç–Ω–∏–∫/–ø–æ–ª–µ":"–ó–æ–Ω–∞";
  const cropTitle=(c)=>c==="strawberry"?"–ü–æ–ª—É–Ω–∏—Ü—è":c==="garlic"?"–ß–∞—Å–Ω–∏–∫":c==="flowers_general"?"–ö–≤—ñ—Ç–∏":"–Ü–Ω—à–µ";

  function zoneTips(zone){
    const m=(new Date()).getMonth();
    const tips=[];
    if(zone.crop==="strawberry"){
      if(m===0||m===1){
        tips.push("–Ø–∫—â–æ –±—É–¥–µ –Ω–∞—Å—Ç—Ä—ñ–π ‚Äî –≥–ª—è–Ω—å, —á–∏ –Ω–µ –æ–≥–æ–ª–∏–ª–∏—Å—å –∫–æ—Ä–µ–Ω—ñ –ø—ñ—Å–ª—è –≤—ñ—Ç—Ä—É/–≤—ñ–¥–ª–∏–≥.");
        tips.push("–Ø–∫—â–æ “ë—Ä—É–Ω—Ç –º–æ–∫—Ä–∏–π —ñ –≤–∞–∂–∫–∏–π ‚Äî –∫—Ä–∞—â–µ –Ω–µ —á—ñ–ø–∞—Ç–∏, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –º—É–ª—å—á—É/—É–∫—Ä–∏—Ç—Ç—è.");
        tips.push("–Ø–∫—â–æ –±–µ–∑ —Å–Ω—ñ–≥—É –π –º–æ—Ä–æ–∑–Ω–æ ‚Äî –ª–µ–≥–∫–µ —É–∫—Ä–∏—Ç—Ç—è/–º—É–ª—å—á–∞ –º–æ–∂–µ –±—É—Ç–∏ –¥–æ—Ä–µ—á–Ω–æ—é.");
      } else if(m===2){
        tips.push("–Ø–∫—â–æ –ø–æ—Ç–µ–ø–ª—ñ–ª–æ ‚Äî –º–æ–∂–Ω–∞ –ø–æ—Ç—Ä–æ—Ö—É –ø—Ä–∏–±—Ä–∞—Ç–∏ —Å—É—Ö–µ –ª–∏—Å—Ç—è (–±–µ–∑ —Ñ–∞–Ω–∞—Ç–∏–∑–º—É).");
      } else if(m===3){
        tips.push("–Ø–∫—â–æ –∑–µ–º–ª—è –ø—ñ–¥—Å–æ—Ö–ª–∞ ‚Äî –ª–µ–≥–∫–µ –ø—ñ–¥–∂–∏–≤–ª–µ–Ω–Ω—è –∑–∞ –±–∞–∂–∞–Ω–Ω—è–º —ñ —Ä–æ–∑–ø—É—à–∏—Ç–∏ –º—ñ–∂—Ä—è–¥–¥—è.");
      } else {
        tips.push("–Ø–∫—â–æ –±—É–¥–µ –Ω–∞—Å—Ç—Ä—ñ–π ‚Äî –ª–µ–≥–∫–∏–π –æ–≥–ª—è–¥ —ñ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤–æ–ª–æ–≥–∏ –±–µ–∑ –ø–µ—Ä–µ–ª–∏–≤—É üôÇ");
      }
    } else if(zone.crop==="garlic"){
      tips.push("–Ø–∫—â–æ –±—É–¥–µ –Ω–∞—Å—Ç—Ä—ñ–π ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä, —á–∏ –Ω–µ ‚Äú–≤–∏–ø–µ—Ä–ª–æ‚Äù –∑—É–±—Ü—ñ –ø—ñ—Å–ª—è –º–æ—Ä–æ–∑—É/–≤—ñ–¥–ª–∏–≥–∏.");
    } else if(zone.crop==="flowers_general"){
      tips.push("–ú‚Äô—è–∫–æ: –æ–≥–ª—è–¥ –∑–∏–º—ñ–≤–ª—ñ/—É–∫—Ä–∏—Ç—Ç—è, –±–µ–∑ —Ä—ñ–∑–∫–∏—Ö —Ä—É—Ö—ñ–≤ üôÇ");
    } else {
      tips.push("–ú‚Äô—è–∫–∏–π –æ–≥–ª—è–¥: –≤–æ–ª–æ–≥–∞/—É–∫—Ä–∏—Ç—Ç—è/–ø–æ—Ä—è–¥–æ–∫ –Ω–∞ –∑–æ–Ω—ñ.");
    }
    return tips;
  }

  function renderZones(){
    const zones=loadZones();
    $("zoneCount").textContent=String(zones.length);
    $("emptyZones").style.display=zones.length?"none":"block";
    const list=$("zoneList"); list.innerHTML="";
    for(const z of zones){
      const size=(z.len&&z.wid)?`${z.len}√ó${z.wid} –º`:"—Ä–æ–∑–º—ñ—Ä –Ω–µ –≤–∫–∞–∑–∞–Ω–æ";
      const tips=zoneTips(z);
      const div=document.createElement("div"); div.className="item";
      div.innerHTML=`<b>${z.name||zoneTypeTitle(z.type)}</b>
        <div class="meta">${zoneTypeTitle(z.type)} ‚Ä¢ ${size}</div>
        <div class="meta">${cropTitle(z.crop)} ‚Ä¢ –∫—ñ–ª—å–∫—ñ—Å—Ç—å: ${z.qty||"‚Äî"}${z.note?" ‚Ä¢ "+z.note:""}</div>
        <div class="meta" style="margin-top:6px;">–ü—ñ–¥–∫–∞–∑–∫–∏ (–º‚Äô—è–∫–æ):</div>
        <div class="meta">‚Ä¢ ${tips[0]||"‚Äî"}</div>
        ${tips[1]?`<div class="meta">‚Ä¢ ${tips[1]}</div>`:""}
        <div class="btnRow" style="margin-top:10px;"><button data-zdel="${z.id}">üóë –í–∏–¥–∞–ª–∏—Ç–∏</button></div>`;
      list.appendChild(div);
    }
    list.querySelectorAll("button[data-zdel]").forEach(btn=>{
      btn.addEventListener("click",()=>{ const id=btn.getAttribute("data-zdel"); saveZones(loadZones().filter(x=>x.id!==id)); renderAll();});
    });
  }

  // --- soft reminders (sowings + zones)
  function renderSoftReminders(){
    const box=$("softReminders");
    box.innerHTML="";
    let count=0;

    for(const r of computeSowingReminders()){
      const div=document.createElement("div"); div.className="item";
      div.innerHTML=`<b>${r.title}</b><div class="meta">${r.text}</div>${r.note?`<div class="meta">–ù–æ—Ç–∞—Ç–∫–∞: ${r.note}</div>`:""}<div class="meta">–ü—ñ–¥–∫–∞–∑–∫–∞: ${r.hint}</div>`;
      box.appendChild(div); count++;
    }

    // append a few zone tips (keep light)
    for(const z of loadZones()){
      if(count>=6) break;
      const tips=zoneTips(z);
      const div=document.createElement("div"); div.className="item";
      div.innerHTML=`<b>${z.name||zoneTypeTitle(z.type)} ‚Ä¢ ${cropTitle(z.crop)}</b><div class="meta">${tips[0]}</div>`;
      box.appendChild(div); count++;
    }

    $("noReminders").style.display = count===0 ? "block" : "none";
  }

  // --- done tracker
  const DONE_KEY="my_garden_done_v1";
  function loadDone(){ try{return JSON.parse(localStorage.getItem(DONE_KEY)||"{}");}catch{return{};} }
  function saveDone(o){ localStorage.setItem(DONE_KEY,JSON.stringify(o)); }

  function wireDone(){
    const key=isoDate(new Date());
    const done=loadDone();
    const hint=$("doneHint");
    const render=()=>{ hint.textContent = done[key]
      ? "–°—É–ø–µ—Ä üôÇ –Ø –≤—ñ–¥–º—ñ—Ç–∏–ª–∞, —â–æ —Å—å–æ–≥–æ–¥–Ω—ñ —Ç–∏ —â–æ—Å—å –∑—Ä–æ–±–∏–ª–∞. –Ø–∫—â–æ –∑–∞–≤—Ç—Ä–∞ –±—É–¥–µ –≤–∞–∂–∫–æ ‚Äî –Ω—ñ—á–æ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ."
      : "–ú–æ–∂–µ—à –≤—ñ–¥–º—ñ—Ç–∏—Ç–∏, —è–∫—â–æ —Å—å–æ–≥–æ–¥–Ω—ñ —Ö–æ—á —Ç—Ä–æ—à–∫–∏ —â–æ—Å—å –∑—Ä–æ–±–∏–ª–∞. –ê —è–∫—â–æ –Ω—ñ ‚Äî —Ç–µ–∂ –æ–∫ ü§ç";};
    render();
    $("btnDone").addEventListener("click",()=>{ done[key]=true; saveDone(done); render(); });
  }

  // --- forms
  function wireSowingForm(){
    $("sowDate").value=isoDate(new Date());
    $("btnSaveSowing").addEventListener("click",()=>{
      const sow=loadSowings();
      sow.push({id:String(Date.now())+Math.random().toString(16).slice(2), type:$("sowType").value, date:$("sowDate").value, note:$("sowNote").value.trim()});
      saveSowings(sow);
      $("sowNote").value="";
      renderAll();
      go("sowings");
    });
    $("btnClearAll").addEventListener("click",()=>{
      if(confirm("–¢–æ—á–Ω–æ –æ—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –ø–æ—Å—ñ–≤–∏? –¶–µ —Ç—ñ–ª—å–∫–∏ —Ç–≤–æ—ó –ª–æ–∫–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ üôÇ")){ saveSowings([]); renderAll(); }
    });
    $("btnAddSowing").addEventListener("click",()=>{ go("sowings"); window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}); });
  }

  function wireZonesForm(){
    $("btnSaveZone").addEventListener("click",()=>{
      const zones=loadZones();
      zones.push({
        id:String(Date.now())+Math.random().toString(16).slice(2),
        type:$("zoneType").value,
        name:$("zoneName").value.trim(),
        len:$("zoneLen").value.trim(),
        wid:$("zoneWid").value.trim(),
        crop:$("zoneCrop").value,
        qty:$("zoneQty").value.trim(),
        note:$("zoneNote").value.trim()
      });
      saveZones(zones);
      $("zoneName").value=""; $("zoneLen").value=""; $("zoneWid").value=""; $("zoneQty").value=""; $("zoneNote").value="";
      renderAll(); go("zones");
    });

    $("btnAddStrawberry").addEventListener("click",()=>{
      const zones=loadZones();
      zones.push({
        id:String(Date.now())+Math.random().toString(16).slice(2),
        type:"high_bed",
        name:"–í–∏—Å–æ–∫–∞ –≥—Ä—è–¥–∫–∞ ‚Ññ1",
        len:"2",
        wid:"1",
        crop:"strawberry",
        qty:"24",
        note:"–ø–µ—Ä–µ—Å–∞–¥–∏–ª–∞ –≤–æ—Å–µ–Ω–∏"
      });
      saveZones(zones);
      renderAll(); go("zones");
    });

    $("btnClearZones").addEventListener("click",()=>{
      if(confirm("–û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –∑–æ–Ω–∏?")){ saveZones([]); renderAll(); }
    });
  }

  // --- calendar demo
  function renderCalendarDemo(now){
    const list=$("calendarList"); list.innerHTML="";
    for(let i=0;i<7;i++){
      const d=new Date(now.getFullYear(),now.getMonth(),now.getDate()+i);
      const c=fallbackDaily(d);
      const dateStr=d.toLocaleDateString("uk-UA",{weekday:"short",day:"2-digit",month:"2-digit"});
      const div=document.createElement("div"); div.className="item";
      div.innerHTML=`<b>${dateStr}</b><div class="meta">üü¢ ${c.easy[0]}</div><div class="meta">üü° ${c.do[0]}</div><div class="meta">üîµ ${c.sow[0]}</div>`;
      list.appendChild(div);
    }
  }

  // --- navigation
  function go(where){
    document.querySelectorAll("nav a").forEach(a=>a.classList.remove("active"));
    document.querySelectorAll(".view").forEach(v=>v.classList.remove("active"));
    document.querySelector(`nav a[data-go="${where}"]`).classList.add("active");
    $("view-"+where).classList.add("active");
  }
  function wireNav(){
    document.querySelectorAll("nav a").forEach(a=>{
      a.addEventListener("click",(e)=>{ e.preventDefault(); go(a.getAttribute("data-go")); });
    });
  }

  function renderAll(){
    renderSowings();
    renderZones();
    renderSoftReminders();
  }

  // init
  setTodayContent();
  wireNav();
  wireDone();
  wireSowingForm();
  wireZonesForm();
  renderAll();

  // service worker (offline). If iOS is stubborn, bump CACHE name in sw.js.
  if("serviceWorker" in navigator){
    navigator.serviceWorker.register("./sw.js").catch(()=>{});
  }
</script>
</body>
</html>
